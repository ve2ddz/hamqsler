<?xml version='1.0' encoding='UTF-8'?>
<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:lang="en"
		 xmlns:xlink="http://www.w3.org/1999/xlink"
		 xml:id="carddesign">
	<title>Working With Cards</title>
	<section>
		<title>Saving HamQSLer Card Files</title>
		<para>Once a card has been created, it may be saved to be loaded
		and used at a future time. To do this, select the Cards->File Save or
		Cards->File Save As... menu items. File Save is only available if the
		card has previously been saved because the program must know the
		directory in which you want to save the card.</para>
		<para>When you select the Card Save As... menu item, the File Save As
		dialog, shown below, is displayed.</para>
		<figure xml:id="savecarddialog2">
			<title>File Save As Dialog</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/savecarddialog.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>The dialog opens with the default directory set to your hamqsler
		folder. Navigate to the folder where you want to save the card file,
		enter the name you want to save the file as, and
		then click on the Save button. The card file will be saved and the
		dialog will close.</para>
	</section>
	<section>
		<title>Loading HamQSLer Card Files</title>
		<para>Once a card has been saved, it can be loaded at a later time
		by selecting the Cards->Open Card... menu item. This displays the
		File Open dialog with the default directory set to your hamqsler
		folder. See the image below:</para>
		<figure xml:id="cardopendialog">
			<title>File Open Dialog</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/cardopendialog.png" />
				</imageobject>
			</mediaobject>
		</figure>
		
		<para>Navigate to the directory containing the card file you want
		to open, and either click on the file and then the Open button,
		or double-click on the file.</para>
		<tip>
			<para>Keep all of your card related files (card files, images,
			logos, etc.) in the hamqsler directory or create subdirectories
			for each file type. That way, all of the files needed for
			your cards are located in one place so they are easy to back
			up and to move to another location.</para>
			<para>In the past, as Microsoft released new versions of Windows,
			they sometimes changed the location of the My Directories folder.
			This occurred, for example, when Windows Vista was released,
			and people who upgraded from Windows XP had problems with hard-coded 
			paths.</para>
		</tip>
		<tip>
			<para>If you want to reload the saved card or cards every time
			you restart the program, check the "Reload Card Files on Startup"
			checkbox in the User Preferences. See the <link linkend="settinguserprefs">
			User Preferences</link> chapter for more information.</para>
		</tip>
	</section>
	<section>
		<title>Moving and Converting QslDesignAndPrint Files</title>
		<para>QslDesignAndPrint card files are normally stored in the
		<emphasis>QslDnP</emphasis> subdirectory of your My Documents directory. 
		You may also
		have stored other related files such as images, logos, and
		possibly ADIF files in <emphasis>QslDnP</emphasis>.</para>
		<para> 
		HamQSLer uses the <emphasis>hamqsler</emphasis> subdirectory in
		My Documents. To ease the transition from QslDesignAndPrint to
		HamQSLer, a move and convert tool has been included in HamQSLer. 
		This tool performs two tasks:</para>
		<orderedlist>
			<listitem>
				<para>All files except log files, card files, and the user preferences
				file are copied from
				a user selected source directory to a user specified destination directory. 
				These files have the extensions .xqsl, .xml, .log, and .log-old.</para>
			</listitem>
			<listitem>
				<para>Card files are converted from QslDesignAndPrint format to
				HamQSLer format and copied to the 
				destination directory and its subdirectories.</para>
			</listitem>
		</orderedlist>
		<para>The following files are not copied or converted: ...\Samples\text2.adi,
		...\Samples\moonbasin.jpg, and ...\Samples\sample.xqsl. These three files are
		used in the QslDesignAndPrint getting started tutorial; a different set of
		files is used in the HamQSLer getting started tutorial.</para>
		<para>To copy and convert your QslDesignAndPrint related files, select
		the Tools -> Import QslDesignAndPrint Files menu item. This opens a Browse For
		Folder dialog. Select the directory containing the files you want to copy and
		convert, then click the OK button. Another Browse For Folder dialog will open;
		use this dialog to select the destination directory, and click the OK button.
		Copying and conversion will begin.</para>
		<para>If one or more errors occur when copying files from the source directory
		to the destination directory,
		the following message box will be displayed, and as noted, the file or files
		that could not be copied are listed in the log file along with the reason why.</para>
		<figure xml:id="qsldnpfilecopyerrorbox">
			<title>Copy Error Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/qsldnpcopyerrorbox.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If no files were copied, either because the source directory was empty,
		or because the files in the directory had already been copied to the destination
		directory, the message box shown below is displayed.</para>
		<figure xml:id="nofilescopied">
			<title>No Files Copied Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/nofilescopied.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If the source directory contains no card files, or if there were errors
		detected while converting every card file, then the following message box is
		displayed as a warning.</para>
		<figure xml:id="nocardscoverted">
			<title>No Cards Converted Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/nocardsconverted.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If an image in a QslDesignAndPrint card file references an image
		file in the source directory, then the location of the image
		file is changed to the destination directory. If any image file cannot be located, 
		then the message box shown below is displayed, and you are given the choice
		between trying to locate the file yourself or deleting the image.</para>
		<figure xml:id="imagefilenotfoundbox">
			<title>Image File Not Found Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/imagefilenotfoundbox.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If a font cannot be located, it is replaced by the first font in the
		installed fonts list. See the caution below related to fonts.</para>
		<para>When all files have been moved and all card files have been converted,
		the text "Files have been copied and card files converted. See log file for
		details." is
		displayed in the status bar at the bottom of HamQSLer's main window. The log
		file contains a message for every file copied, every card file converted, every
		image replaced, every font that could not be found, and every error that was
		detected during the copy and conversion tasks.</para>
		<caution>
			<para>HamQSLer uses a different graphical user interface than 
			QslDesignAndPrint to draw cards. In some cases, font face names are
			different; if your card file references one of these font face names,
			then the card will not display text in your selected font. The font will
			be replaced by the first font in the installed fonts list. You may of course 
			change the font face at any time while the card is in design mode.</para>
			<para>QslDesignAndPrint used Windows Presentation Foundation (WPF) to
			print and display cards. HamQSLer uses Windows Forms libraries for
			printing and displaying cards. There are two potential differences between
			these libraries as related to fonts:</para>
			<orderedlist>
				<listitem>
					<para>WPF enumerates all fonts that are installed on your computer.
					Windows forms only enumerates installed fonts that are located in
					your Fonts directory.</para>
				</listitem>
				<listitem>
					<para>There may be small differences in names between the list of
					installed fonts returned by WPF and by Windows Forms. This only
					affects a few font names.</para>
				</listitem>
			</orderedlist>
			<para>For these reasons, one or more of the fonts on your QslDesignAndPrint
			cards may be replaced by the first font in the Windows Forms installed fonts
			list during the conversion process.</para>
		</caution>
		<caution>
			<para>QslDesignAndPrint supports three font weights: 
			<emphasis>normal</emphasis>, <emphasis>bold</emphasis>, 
			and <emphasis>black</emphasis>.
			HamQSLer only supports <emphasis>normal</emphasis> and 
			<emphasis>bold</emphasis>. For most font faces used in
			QslDesignAndPrint, <emphasis>black</emphasis> is simply displayed as 
			<emphasis>bold</emphasis>. The one obvious
			font face for which there is a <emphasis>black</emphasis> font weight is Arial.
			</para>
			<para>An Arial Black font is available on the Internet, but it does not
			look like Arial with a font weight of black. An alternative to Arial Black
			is Helvetica Black.  You may purchase Helvetica fonts, but they
			are not available free of charge, and will only be available on your
			computer if another application has loaded them.</para>
			<para>An alternative font face with thicker characters is Verdana, although
			character shapes are different from Arial.</para>
		</caution>
	</section>
</chapter>
