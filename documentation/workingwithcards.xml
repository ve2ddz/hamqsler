<?xml version='1.0' encoding='UTF-8'?>
<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:lang="en"
		 xmlns:xlink="http://www.w3.org/1999/xlink"
		 xml:id="carddesign">
	<title>Working With Cards</title>
	<section>
		<title>Saving HamQSLer Card Files</title>
		<para>Once a card has been created, it may be saved to be loaded
		and used at a future time. To do this, select the Cards->File Save or
		Cards->File Save As... menu items. File Save is only available if the
		card has previously been saved because the program must know the
		directory in which you want to save the card.</para>
		<para>When you select the Card Save As... menu item, the File Save As
		dialog, shown below, is displayed.</para>
		<figure xml:id="savecarddialog2">
			<title>File Save As Dialog</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/savecarddialog.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>The dialog opens in the default card files folder. This folder can
		be set in user preferences. See <link linkend='settinguserprefs'>Setting
		User Preferences</link> for setting this value. 
		Navigate to the folder where you want to save the card file,
		enter the name you want to save the file as, and
		then click on the Save button. The card file will be saved and the
		dialog will close.</para>
	</section>
	<section>
		<title>Loading HamQSLer Card Files</title>
		<para>Once a card has been saved, it can be loaded at a later time
		by selecting the Cards->Open Card... menu item. This displays the
		File Open dialog with the default directory set to the default card files
		folder. See the image below:</para>
		<figure xml:id="cardopendialog">
			<title>File Open Dialog</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/cardopendialog.png" />
				</imageobject>
			</mediaobject>
		</figure>
		
		<para>Navigate to the directory containing the card file you want
		to open, and either click on the file and then the Open button,
		or double-click on the file.</para>
		<tip>
			<para>Keep all of your card related files (card files, images,
			logos, etc.) in the hamqsler directory or create subdirectories
			for each file type. That way, all of the files needed for
			your cards are located in one place so they are easy to back
			up and to move to another location.</para>
			<para>In the past, as Microsoft released new versions of Windows,
			they sometimes changed the location of the My Directories folder.
			This occurred, for example, when Windows Vista was released,
			and people who upgraded from Windows XP had problems with hard-coded 
			paths.</para>
		</tip>
		<tip>
			<para>If you want to reload the saved card or cards every time
			you restart the program, check the "Reload Card Files on Startup"
			checkbox in the User Preferences. See the <link linkend="settinguserprefs">
			User Preferences</link> chapter for more information.</para>
		</tip>
	</section>
	<section>
		<title>Moving and Converting QslDesignAndPrint Files</title>
		<para>QslDesignAndPrint card files are normally stored in the
		<emphasis>QslDnP</emphasis> subdirectory of your My Documents directory. 
		You may also
		have stored other related files such as images, logos, and
		possibly ADIF files in <emphasis>QslDnP</emphasis>.</para>
		<para> 
		HamQSLer uses the <emphasis>hamqsler</emphasis> subdirectory in
		My Documents. To ease the transition from QslDesignAndPrint to
		HamQSLer, a move and convert tool has been included in HamQSLer. 
		This tool performs two tasks:</para>
		<orderedlist>
			<listitem>
				<para>All files except log files, card files, and the user preferences
				file are copied from
				a user selected source directory to a user specified destination directory. 
				These files have the extensions .xqsl, .xml, .log, and .log-old.</para>
			</listitem>
			<listitem>
				<para>Card files are converted from QslDesignAndPrint format to
				HamQSLer format and copied to the 
				destination directory and its subdirectories.</para>
			</listitem>
		</orderedlist>
		<para>The following files are not copied or converted: ...\Samples\text2.adi,
		...\Samples\moonbasin.jpg, and ...\Samples\sample.xqsl. These three files are
		used in the QslDesignAndPrint getting started tutorial; a different set of
		files is used in the HamQSLer getting started tutorial.</para>
		<para>To copy and convert your QslDesignAndPrint related files, select
		the Tools -> Import QslDesignAndPrint Files menu item. This opens a Browse For
		Folder dialog. Select the directory containing the files you want to copy and
		convert, then click the OK button. Another Browse For Folder dialog will open;
		use this dialog to select the destination directory, and click the OK button.
		Copying and conversion will begin.</para>
		<para>If one or more errors occur when copying files from the source directory
		to the destination directory,
		the following message box will be displayed, and as noted, the file or files
		that could not be copied are listed in the log file along with the reason why.</para>
		<figure xml:id="qsldnpfilecopyerrorbox">
			<title>Copy Error Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/qsldnpcopyerrorbox.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If no files were copied, either because the source directory was empty,
		or because the files in the directory had already been copied to the destination
		directory, the message box shown below is displayed.</para>
		<figure xml:id="nofilescopied">
			<title>No Files Copied Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/nofilescopied.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If the source directory contains no card files, or if there were errors
		detected while converting every card file, then the following message box is
		displayed as a warning.</para>
		<figure xml:id="nocardscoverted">
			<title>No Cards Converted Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/nocardsconverted.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If an image in a QslDesignAndPrint card file references an image
		file in the source directory, then the location of the image
		file is changed to the destination directory. If any image file cannot be located, 
		then the message box shown below is displayed, and you are given the choice
		between trying to locate the file yourself or deleting the image.</para>
		<figure xml:id="imagefilenotfoundbox">
			<title>Image File Not Found Message Box</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/imagefilenotfoundbox.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>If a font cannot be located, it is replaced by the first font in the
		installed fonts list. See the caution below related to fonts.</para>
		<para>When all files have been moved and all card files have been converted,
		the text "Files have been copied and card files converted. See log file for
		details." is
		displayed in the status bar at the bottom of HamQSLer's main window. The log
		file contains a message for every file copied, every card file converted, every
		image replaced, every font that could not be found, and every error that was
		detected during the copy and conversion tasks.</para>
		<caution>
			<para>HamQSLer uses a different graphical user interface than 
			QslDesignAndPrint to draw cards. In some cases, font face names are
			different; if your card file references one of these font face names,
			then the card will not display text in your selected font. The font will
			be replaced by the first font in the installed fonts list. You may of course 
			change the font face at any time while the card is in design mode.</para>
			<para>QslDesignAndPrint used Windows Presentation Foundation (WPF) to
			print and display cards. HamQSLer uses Windows Forms libraries for
			printing and displaying cards. There are two potential differences between
			these libraries as related to fonts:</para>
			<orderedlist>
				<listitem>
					<para>WPF enumerates all fonts that are installed on your computer.
					Windows forms only enumerates installed fonts that are located in
					your Fonts directory.</para>
				</listitem>
				<listitem>
					<para>There may be small differences in names between the list of
					installed fonts returned by WPF and by Windows Forms. This only
					affects a few font names.</para>
				</listitem>
			</orderedlist>
			<para>For these reasons, one or more of the fonts on your QslDesignAndPrint
			cards may be replaced by the first font in the Windows Forms installed fonts
			list during the conversion process.</para>
		</caution>
		<caution>
			<para>QslDesignAndPrint supports three font weights: 
			<emphasis>normal</emphasis>, <emphasis>bold</emphasis>, 
			and <emphasis>black</emphasis>.
			HamQSLer only supports <emphasis>normal</emphasis> and 
			<emphasis>bold</emphasis>. For most font faces used in
			QslDesignAndPrint, <emphasis>black</emphasis> is simply displayed as 
			<emphasis>bold</emphasis>. The one obvious
			font face for which there is a <emphasis>black</emphasis> font weight is Arial.
			</para>
			<para>An Arial Black font is available on the Internet, but it does not
			look like Arial with a font weight of black. An alternative to Arial Black
			is Helvetica Black.  You may purchase Helvetica fonts, but they
			are not available free of charge, and will only be available on your
			computer if another application has loaded them.</para>
			<para>An alternative font face with thicker characters is Verdana, although
			character shapes are different from Arial.</para>
		</caution>
	</section>
	<section>
		<title>Creating a New Card</title>
		<para>A new card may be created by selecting the Cards -> New menu item. This
		opens another submenu from which to select the card size and orientation that
		you want. At this time, there are three card sizes available:</para>
		<itemizedlist>
			<listitem>
				<para>Bureau sized card in landscape mode (5.5 inches wide by 3.5 inches high,
				or 139.7 mm wide by 88.9 mm high). This is the standard size for QSL cards
				and is the size preferred by all QSL bureaus. There are three known suppliers
				of perforated cardstock for this size of card. See the
				<link linkend='outputtingcards'>Outputting Cards</link> chapter for more
				information.</para>
			</listitem>
			<listitem>
				<para>5.5 inches wide by 4.25 inches wide in landscape mode (139.7 mm wide by
				107.95 mm high). Four of these cards may be printed in a two by two layout
				on US Letter sized card stock. A number of micro-perforated cardstocks are
				available in this size. See the
				<link linkend='outputtingcards'>Outputting Cards</link> chapter for more
				information.</para>
			</listitem>
			<listitem>
				<para>6 inches wide by 4 inches high in landscape mode (152.4 mm wide by
				101.6 mm high). This corresponds to standard 4 inch by 6 inch or 10 cm by
				15 cm photopaper.</para>
			</listitem>
		</itemizedlist>
		<para>Select the card size that you want. The new card will be displayed in a new
		tab in the main window; this tab displays the card in design mode in the panel
		on the left, and a properties panel on the right. If you set up the various text 
		items properties in User Preferences, as outlined in the 
		<link linkend='settinguserprefs'>Setting User Preferences</link> chapter,
		then a card similar to the image below will be displayed. The card in this image is
		bureau sized. If you select a different size card, then that size of card is
		displayed.</para>
		<figure xml:id="newcard2">
			<title>New Bureau Sized Card When First Created</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/newcard.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>The tab header contains the text "New Card" and the window title is "HamQSLer -
		New Card. Once you have changed one of the card properties, the tab header will change
		to *New Card, and the window title will change to "HamQSLer - New Card - Modified"
		to show that one or more changes have been made to the card. When you save the card,
		the tab header will contain the name of the file that you saved the card to, and the
		window title will contain "HamQSLer - <emphasis>full path to card file</emphasis>.</para>
		<para>Again when you modify the card further, an asterisk ("*") will be prepended to the 
		tab header, and " - Modified" will be appended to the window title.</para>
		<para>The properties panel on the right side of the card tab contains default printer and
		print properties for the card, or card item specific properties when a card item is
		selected. Card default printer and print properties are discussed in the
		<link linkend='outputtingcards'>Outputting Cards</link> chapter and therefore
		will not be mentioned further here.</para>
		<para>Cards that are designed using HamQSLer may contain:</para>
		<itemizedlist>
			<listitem>
				<para>A background image.</para>
			</listitem>
			<listitem>
				<para>Any number of secondary images.</para>
			</listitem>
			<listitem>
				<para>Any number of text items.</para>
			</listitem>
			<listitem>
				<para>Zero or one QSOs Box which contains QSO information.</para>
			</listitem>
		</itemizedlist>
		<para>A new card contains no background or secondary images; three text items:
		callsign, name and QTH, and a salutation; and a QSOs Box. Any item on a card may be
		deleted from the card, and any item may be added to the card. Background image is a
		special case. The actual image may be cleared, but the background image item is still
		maintained as an item on the card. The QSOs Box is also a special case. Only one
		QSOs Box is permitted on a card, so it is only possible to add a QSOs Box if the
		original QSOs Box has been deleted.</para>
		<para>The following sections deal with the properties of each card item type, but
		first we will discuss card design related menu items and then highlighting and 
		selecting card items.</para>
	</section>
	<section>
		<title>Card Design Related Menus and Menu Items</title>
		<section>
			<title>Card Design Context Menu</title>
			<para>The card design context menu, shown below, is displayed by clicking the right
			mouse button anywhere within the card design panel. The menu items that are enabled
			and disabled are determined by the placement of the cursor when the mouse button
			was clicked and on a number of design conditions. For example, the Clear Background
			Image menu item is only enabled if there is a background image.</para>
			<figure xml:id="carddesigncontextmenu">
				<title>Card Design Context Menu</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/carddesigncontextmenu.png" />
					</imageobject>
				</mediaobject>
			</figure>
			<para>This table shows the menu items and their actions.</para>
			<table frame='all'>
				<title>Card Design Context Menu Items and Actions</title>
				<tgroup cols='2' align='left' colsep='1' rowsep='1'>
					<colspec colname='MenuItem' />
					<colspec colname='Action'/>
					<thead>
					<row>
						<entry namest='MenuItem'>Menu Item</entry>
						<entry namest='Action'>Action</entry>
					</row>
					</thead>
					<tbody>
						<row>
							<entry>Select Highlighted Item</entry>
							<entry>Selects the highlighted card item to allow editing of the
							item's properties. See 
							<link linkend='highlightingitems'>Highlighting and Selecting Card
							Items</link> for more information.</entry>
						</row>
						<row>
							<entry>Deselect Item</entry>
							<entry>Deselects the selected card item. See 
							<link linkend='highlightingitems'>Highlighting and Selecting Card
							Items</link> for more information.</entry>
						</row>
						<row>
							<entry>Add Image</entry>
							<entry>Adds a new secondary image to the card and selects it
							for editing. See <link linkend='addingimages'>Adding Secondary
							Images</link> for more information.</entry>
						</row>
						<row>
							<entry>Add Text Item</entry>
							<entry>Adds a new text item to the card. See
							<link linkend='addingtextitems'>Add New Text Items</link> for
							more information.</entry>
						</row>
						<row>
							<entry>Add Qsos Box</entry>
							<entry>Adds a new Qsos Box to the card. See
							<link linkend='addingqsosbox'>Adding a Qsos Box</link> for
							more information.</entry>
						</row>
						<row>
							<entry>Delete Selected Item</entry>
							<entry>Deletes the selected card item from the card. See
							<link linkend='deletingitem'>Deleting a Card Item</link>
							for more information.</entry>
						</row>
						<row>
							<entry>Clear Background Image</entry>
							<entry>Clears the background image. See
							<link linkend='clearbackground'>Clearing the Background
							Image</link> for more information</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
		<section>
			<title>Edit Dropdown Menu</title>
			<figure xml:id="editmenu">
				<title>Edit Dropdown Menu</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/editmenu.png" />
					</imageobject>
				</mediaobject>
			</figure>
			<para>The image above shows the open Edit dropdown menu. The table shows the 
			card design related menu items and their actions.</para>
			<table frame='all'>
				<title>Card Design Related Edit Dropdown Menu Items and Actions</title>
				<tgroup cols='2' align='left' colsep='1' rowsep='1'>
					<colspec colname='MenuItem' />
					<colspec colname='Action'/>
					<thead>
					<row>
						<entry namest='MenuItem'>Menu Item</entry>
						<entry namest='Action'>Action</entry>
					</row>
					</thead>
					<tbody>
						<row>
							<entry>Add Image</entry>
							<entry>Adds a new secondary image to the card and selects it
							for editing. See <link linkend='addingimages'>Adding Secondary
							Images</link> for more information.</entry>
						</row>
						<row>
							<entry>Add Text Item</entry>
							<entry>Adds a new text item to the card. See
							<link linkend='addingtextitems'>Add New Text Items</link> for
							more information.</entry>
						</row>
						<row>
							<entry>Add Qsos Box</entry>
							<entry>Adds a new Qsos Box to the card. See
							<link linkend='addingqsosbox'>Adding a Qsos Box</link> for
							more information.</entry>
						</row>
						<row>
							<entry>Delete Selected Item</entry>
							<entry>Deletes the selected card item from the card. See
							<link linkend='deletingitem'>Deleting a Card Item</link>
							for more information.</entry>
						</row>
						<row>
							<entry>Clear Background Image</entry>
							<entry>Clears the background image. See
							<link linkend='clearbackground'>Clearing the Background
							Image</link> for more information</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
		<section xml:id='selectmenu2'>
			<title>Select Dropdown Menu</title>
			<para>The image below shows a sample dropdown menu. The contents of the menu
			above the separator (the line) changes depending on image and text item properties.
			For example, the first item in the menu is "Background" if there
			is no background image, and the file name of the background image if there is
			one. Similarly, each secondary image has a menu item: "Image" if
			there is no image loaded, and the file name of the image if there is one loaded.
			Menu items for each text item contains the first 10 characters of the design text
			for the text item.</para>
			<figure xml:id="sampleselectmenu">
				<title>Sample Select Dropdown Menu</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/sampleselectmenu.png" />
					</imageobject>
				</mediaobject>
			</figure>
			<para>The following table shows the menu items and their actions. See
			<link linkend='highlightingitems'>Highlighting and Selecting Card Items</link>
			for more information on selecting card items.</para>
			<table frame='all'>
				<title>Card Design Related Select Dropdown Menu Items and Actions</title>
				<tgroup cols='2' align='left' colsep='1' rowsep='1'>
					<colspec colname='MenuItem' />
					<colspec colname='Action'/>
					<thead>
					<row>
						<entry namest='MenuItem'>Menu Item</entry>
						<entry namest='Action'>Action</entry>
					</row>
					</thead>
					<tbody>
						<row>
							<entry>Background</entry>
							<entry>Selects the background image. This menu item only
							appears when there is no image specified for the background.</entry>
						</row>
						<row>
							<entry>Image</entry>
							<entry>Selects the secondary image. This menu item only
							appears for secondary images that do not have an image file
							specified.</entry>
						</row>
						<row>
							<entry><emphasis>image file name</emphasis></entry>
							<entry>Selects the background or secondary image item that
							has this file name specified.</entry>
						</row>
						<row>
							<entry><emphasis>text</emphasis></entry>
							<entry>Selects the text item whose design text starts with
							this text.</entry>
						</row>
						<row>
							<entry>Qsos Box</entry>
							<entry>Selects the Qsos Box card item. This menu item only appears
							if there is a Qsos Box on the card.</entry>
						</row>
						<row>
							<entry>None</entry>
							<entry>Deselects the selected card item.</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
	</section>
	<section xml:id='highlightingitems'>
		<title>Highlighting and Selecting Card Items</title>
		<para>When you move the mouse cursor over any card item on the card, that card item
		is highlighted or outlined with an orange dashed line. For example, the image below
		shows the salutation text item highlighted because the mouse cursor is over it.</para>
		<figure xml:id="highlighteditem">
			<title>Salutation Text Item Highlighted</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/highlighteditem.png" />
				</imageobject>
			</mediaobject>
		</figure>
		<para>As mentioned earlier, the background image is a special card item. If there
		is a background image on the card, that image is highlighted when the cursor moves
		over it; if there is no background image present, then the card is outlined. This is
		done so that you know there is no background image for the card and so that the
		background may be selected.</para>
		<para>Card items may overlap. When you move the mouse cursor over the area where these
		card items overlap, the card item with higher precedence is highlighted. The list below
		shows the precedence of card items from highest to lowest:</para>
		<simplelist>
			<member>Qsos Box.</member>
			<member>Text items in the reverse of the order that they were created in.</member>
			<member>Secondary images in the reverse of the order that they were created in.
			</member>
			<member>Background.</member>
		</simplelist>
		<para>A card item may be selected in one of two ways:</para>
		<orderedlist>
			<listitem>
				<para>Move the cursor over the card item to highlight it, then click the right
				mouse button to open the card item context menu. Select the "Select Highlighted
				Item" menu item from the context menu. The contents of this context menu is
				discussed in the <link linkend='carddesigncontextmenu'>Card Design
				Context Menu</link> section, above.</para>
			</listitem>
			<listitem>
				<para>Select the card item from the Select dropdown menu. More information
				about this menu is provided in the <link linkend='selectmenu2'>Select Dropdown
				Menu</link> section, above.</para>
			</listitem>
		</orderedlist>
		<para>When a card item has been selected, the card item is outlined by a dark blue
		dashed outline, and the properties for the card item are displayed in the card
		properties panel. Editing of card item properties is discussed in a number of sections
		that follow.</para>
		<para>The image below shows the salutation text item that was highlighted in the image
		above once the item has been selected.</para>
		<figure xml:id="selecteditem">
			<title>Salutation Text Item Selected</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/selecteditem.png" />
				</imageobject>
			</mediaobject>
		</figure>
	</section>
	<section>
		<title>Deselecting Selected Card Items</title>
		<para>A card item may be deselected in either of the following ways:</para>
		<orderedlist>
			<listitem>
				<para>Open the card item context menu and select the "Deselect Item"
				menu item.</para>
			</listitem>
			<listitem>
				<para>Select the "None" menu item from the Select dropdown menu.</para>
			</listitem>
		</orderedlist>
		<para>When the card item is deselected, it is no longer highlighted by a dark
		blue dashed line.</para>
	</section>
	<section xml:id='addingimages'>
		<title>Adding Secondary Images</title>
		<para>To be written.</para>
	</section>
	<section xml:id='addingtextitems'>
		<title>Adding New Text Items</title>
		<para>To be written.</para>
	</section>
	<section xml:id='addingqsosbox'>
		<title>Adding a Qsos Box</title>
		<para>To be written.</para>
	</section>
	<section xml:id='deletingitem'>
		<title>Deleting a Card Item</title>
		<para>To be written.</para>
	</section>
	<section xml:id='clearbackground'>
		<title>Clearing the Background Image</title>
		<para>To be written.</para>
	</section>
</chapter>
